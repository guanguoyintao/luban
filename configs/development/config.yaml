# 推荐系统配置文件

# 服务器配置
server:
  host: 0.0.0.0
  port: 8080
  timeout: 30
  read_timeout: 30
  write_timeout: 30
  idle_timeout: 60
  max_header_bytes: 1048576

# 日志配置
logging:
  level: info
  format: json
  output: stdout
  file:
    path: logs/recommendation.log
    max_size: 100
    max_backups: 10
    max_age: 30
    compress: true

# Redis配置
redis:
  host: localhost
  port: 6379
  password: ""
  database: 0
  pool_size: 10
  max_retries: 3
  dial_timeout: 5
  read_timeout: 3
  write_timeout: 3
  idle_timeout: 300
  max_active_conns: 100
  max_idle_conns: 50

# MySQL配置
mysql:
  host: localhost
  port: 3306
  database: recommendation_system
  username: root
  password: ""
  charset: utf8mb4
  collation: utf8mb4_unicode_ci
  max_connections: 100
  max_idle_connections: 50
  max_lifetime: 3600
  log_level: info
  slow_threshold: 200

# MongoDB配置
mongodb:
  uri: mongodb://localhost:27017
  database: recommendation_system
  timeout: 10
  pool_size: 10
  max_retries: 3

# Elasticsearch配置
elasticsearch:
  addresses:
    - http://localhost:9200
  username: ""
  password: ""
  index_prefix: recommendation
  timeout: 10
  max_retries: 3

# Kafka配置
kafka:
  brokers:
    - localhost:9092
  client_id: recommendation-system
  version: 2.6.0
  timeout: 10
  max_retries: 3

# 推荐算法配置
algorithms:
  enabled:
    - collaborative_filtering
    - content_based_filtering
    - hybrid_filtering
    - popularity
  
  collaborative_filtering:
    name: "协同过滤算法"
    weight: 0.4
    enabled: true
    parameters:
      neighbors: 50
      similarity_threshold: 0.1
      min_common_items: 2
      max_recommendations: 100
      normalization_method: "mean_centering"
    
  content_based_filtering:
    name: "基于内容过滤算法"
    weight: 0.3
    enabled: true
    parameters:
      feature_weights:
        category: 0.4
        tags: 0.3
        price: 0.2
        brand: 0.1
      similarity_threshold: 0.3
      learning_rate: 0.01
      decay_factor: 0.95
      max_features: 100
    
  hybrid_filtering:
    name: "混合过滤算法"
    weight: 0.2
    enabled: true
    parameters:
      collaborative_weight: 0.5
      content_based_weight: 0.4
      diversity_weight: 0.05
      popularity_weight: 0.03
      recency_weight: 0.02
      enable_diversity: true
      enable_popularity: true
      enable_recency: true
    
  popularity:
    name: "流行度算法"
    weight: 0.1
    enabled: true
    parameters:
      time_window: "7d"
      min_interactions: 10
      decay_factor: 0.9
      category_boost: 1.2

# 推荐策略配置
strategies:
  personalized:
    enabled: true
    weight: 0.6
    priority: 1
    description: "个性化推荐策略"
    
  popular:
    enabled: true
    weight: 0.2
    priority: 2
    description: "热门推荐策略"
    scenarios:
      - home_page
      - search_result
    
  similarity:
    enabled: true
    weight: 0.2
    priority: 3
    description: "相似性推荐策略"
    scenarios:
      - product_detail

# 数据源配置
datasources:
  redis:
    primary:
      enabled: true
      type: redis
      config:
        host: localhost
        port: 6379
        database: 0
        pool_size: 10
        
  mysql:
    primary:
      enabled: true
      type: mysql
      config:
        host: localhost
        port: 3306
        database: recommendation_system
        username: root
        password: ""
        max_connections: 100
        
  mongodb:
    primary:
      enabled: false
      type: mongodb
      config:
        uri: mongodb://localhost:27017
        database: recommendation_system
        pool_size: 10

# 插件配置
plugins:
  enabled: true
  directory: ./plugins
  auto_load: true
  load_order:
    - collaborative_filtering_v1
    - content_based_v1
    - redis_datasource_v1
    - mysql_datasource_v1
    - logging_middleware_v1
    - rate_limit_middleware_v1
  
  configurations:
    collaborative_filtering_v1:
      neighbors: 50
      similarity_threshold: 0.1
      
    content_based_v1:
      feature_weights:
        category: 0.4
        tags: 0.3
        price: 0.2
        brand: 0.1
        
    redis_datasource_v1:
      host: localhost
      port: 6379
      database: 0
      pool_size: 10
      
    mysql_datasource_v1:
      host: localhost
      port: 3306
      database: recommendation_system
      username: root
      password: ""
      max_connections: 100
      
    logging_middleware_v1:
      level: info
      format: json
      output: stdout
      
    rate_limit_middleware_v1:
      requests_per_minute: 60
      burst_size: 10
      key_prefix: rate_limit

# 监控配置
monitoring:
  prometheus:
    enabled: true
    port: 9090
    path: /metrics
    namespace: recommendation_system
    
  jaeger:
    enabled: true
    endpoint: http://localhost:14268/api/traces
    service_name: recommendation-system
    sample_rate: 0.1
    
  health_check:
    enabled: true
    path: /health
    timeout: 5
    checks:
      - redis
      - mysql
      - plugins

# 性能配置
performance:
  cache:
    enabled: true
    ttl: 300
    max_entries: 10000
    
  connection_pool:
    max_idle: 50
    max_active: 100
    idle_timeout: 300
    
  rate_limiting:
    enabled: true
    requests_per_minute: 60
    burst_size: 10
    
  circuit_breaker:
    enabled: true
    failure_threshold: 5
    success_threshold: 2
    timeout: 30

# 安全配置
security:
  auth:
    enabled: true
    jwt_secret: "your-jwt-secret-key"
    token_expiry: 3600
    
  encryption:
    enabled: true
    algorithm: AES-256-GCM
    key: "your-encryption-key-32-bytes-long"
    
  cors:
    enabled: true
    allowed_origins:
      - "*"
    allowed_methods:
      - GET
      - POST
      - PUT
      - DELETE
    allowed_headers:
      - "*"
    
  rate_limiting:
    enabled: true
    requests_per_minute: 60
    burst_size: 10

# 测试配置
testing:
  mock_data:
    enabled: true
    user_count: 1000
    item_count: 5000
    interaction_count: 50000
    
  load_testing:
    enabled: false
    concurrent_users: 100
    requests_per_second: 1000
    duration: 60

# 开发环境配置
development:
  debug: true
  hot_reload: true
  profiling: true
  log_level: debug
  
# 生产环境配置
production:
  debug: false
  hot_reload: false
  profiling: false
  log_level: info